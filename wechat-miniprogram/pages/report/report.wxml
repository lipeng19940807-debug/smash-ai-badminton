<!--pages/report/report.wxml-->
<view class="page-container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="header">
    <view class="header-content">
      <view class="back-btn" bindtap="handleBack">
        <text class="back-icon">â†</text>
      </view>
      <text class="header-title">æ€çƒæ€§èƒ½æŠ¥å‘Š</text>
      <view class="header-right">
        <text class="info-icon">â„¹ï¸</text>
      </view>
    </view>
  </view>

  <scroll-view class="content" scroll-y wx:if="{{!loading && result}}">
    <!-- é€Ÿåº¦å±•ç¤ºåŒºåŸŸ -->
    <view class="speed-section">
      <text class="speed-label">æ€çƒé€Ÿåº¦</text>
      <view class="speed-display">
        <text class="speed-number">{{result.speed}}</text>
        <text class="speed-unit">km/h</text>
      </view>
      <view class="speed-badge">
        <text class="badge-icon">ğŸ“ˆ</text>
        <text class="badge-text">åˆ·æ–°ä¸ªäººæœ€ä½³è®°å½•</text>
      </view>
    </view>

    <!-- æŠ€æœ¯é›·è¾¾å›¾ -->
    <view class="technique-section">
      <view class="section-card">
        <view class="chart-container">
          <view class="section-header">
            <text class="section-icon">ğŸ“Š</text>
            <text class="section-title">æŠ€æœ¯é›·è¾¾å›¾</text>
          </view>
          
          <!-- æŸ±çŠ¶å›¾ -->
          <view class="bars-container">
            <!-- å‘åŠ› -->
            <view class="bar-item">
              <text class="bar-value">{{result.technique.power}}</text>
              <view class="bar-track">
                <view class="bar-fill bar-power" style="height: {{result.technique.power > 100 ? 100 : result.technique.power}}%"></view>
              </view>
              <text class="bar-label">å‘åŠ›</text>
            </view>
            
            <!-- è§’åº¦ -->
            <view class="bar-item">
              <text class="bar-value">{{result.technique.angle}}</text>
              <view class="bar-track">
                <view class="bar-fill bar-angle" style="height: {{result.technique.angle > 100 ? 100 : result.technique.angle}}%"></view>
              </view>
              <text class="bar-label">è§’åº¦</text>
            </view>
            
            <!-- åè°ƒæ€§ -->
            <view class="bar-item">
              <text class="bar-value">{{result.technique.coordination}}</text>
              <view class="bar-track">
                <view class="bar-fill bar-coordination" style="height: {{result.technique.coordination > 100 ? 100 : result.technique.coordination}}%"></view>
              </view>
              <text class="bar-label">åè°ƒæ€§</text>
            </view>
          </view>
        </view>

        <!-- ç»¼åˆè¯„åˆ† -->
        <view class="score-footer">
          <text class="score-label">åŠ¨ä½œè¯„åˆ†ï¼š</text>
          <view class="score-display">
            <text class="score-number">{{result.score}}</text>
            <text class="score-total">ä¼˜å¼‚ (Top {{result.rankPosition || 0}}%)</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ä¸“ä¸šå»ºè®® -->
    <view class="suggestions-section">
      <text class="section-title-text">ä¸“ä¸šå»ºè®®</text>
      <view class="suggestions-card">
        <view class="suggestions-list">
          <view class="suggestion-item" wx:for="{{result.suggestions}}" wx:key="index" wx:for-item="item" wx:for-index="idx">
            <view class="suggestion-icon">{{item.icon || 'ğŸ’¡'}}</view>
            <view class="suggestion-content">
              <text class="suggestion-title">{{item.title}}</text>
              <text class="suggestion-desc">{{item.desc}}</text>
            </view>
          </view>
        </view>
        <!-- å³ä¾§è£…é¥°å›¾ -->
        <view class="suggestion-decoration">
          <view class="decoration-placeholder">ğŸ¸</view>
        </view>
      </view>
    </view>

    <!-- æ’åä¿¡æ¯ -->
    <view class="ranking-section">
      <view class="ranking-card">
        <view class="ranking-left">
          <view class="ranking-icon">ğŸ†</view>
          <view class="ranking-info">
            <text class="ranking-title">å…¨çƒæ’å</text>
            <text class="ranking-subtitle">ä¸šä½™è”èµ› (Lvl 5)</text>
          </view>
        </view>
        <view class="ranking-right">
          <text class="ranking-value">å‰ {{result.rankPosition || 0}}%</text>
          <text class="ranking-region">åœ°åŒº: äºšæ´²</text>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading || !result}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
  
  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-container" wx:if="{{!loading && !result}}">
    <text class="empty-icon">ğŸ“Š</text>
    <text class="empty-text">æš‚æ— åˆ†æç»“æœ</text>
    <button class="empty-btn" bindtap="handleBack">è¿”å›</button>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="footer" wx:if="{{result && !loading}}">
    <button class="share-btn" bindtap="handleShare">
      <text class="share-icon">ğŸ“¤</text>
      <text>åˆ†äº«æˆ˜æŠ¥</text>
    </button>
    <view class="footer-actions">
      <text class="footer-label">å¿«é€Ÿåˆ†äº«åˆ°</text>
      <view class="footer-icons">
        <view class="footer-icon">ğŸ’¬</view>
        <view class="footer-icon">ğŸ“·</view>
        <view class="footer-icon">â¬‡ï¸</view>
      </view>
    </view>
  </view>
</view>
